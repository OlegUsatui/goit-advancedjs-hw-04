{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '22615360-5cbe46b430b53ed17aa097d2d';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst initParams = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 15,\n};\n\nexport async function fetchPhotos(q, page = 1) {\n  const params = new URLSearchParams({\n    ...initParams,\n    page,\n    q,\n  });\n\n  const response = await axios.get(`${BASE_URL}?${params}`);\n  return response.data;\n}","const gallery = document.querySelector('.gallery');\n\nexport function renderPhotos(images) {\n  const markup = images.map(({ largeImageURL, webformatURL, likes, views, tags, comments, downloads}) => {\n    return `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\"\n                data-source=\"${largeImageURL}\"\n                alt=\"${tags}\"\n            />\n        </a>\n        <div class=\"stats\">\n          <div>Likes<span>${likes}</span></div>\n          <div>Views<span>${views}</span></div>\n          <div>Comments<span>${comments}</span></div>\n          <div>Downloads<span>${downloads}</span></div>\n        </div>\n    </li>\n  `;\n  }).join(\"\");\n  gallery.insertAdjacentHTML(\"beforeend\",  markup);\n}\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchPhotos } from './js/pixabay-api.js';\nimport { clearGallery, renderPhotos } from './js/render-functions.js';\n\niziToast.settings({\n  position: 'topRight',\n  progressBar: false,\n  messageColor: '#FFFFFF',\n  icon: '',\n  close: false,\n});\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  const form = document.querySelector('.search-bar');\n  const loadMoreBtn = document.getElementById('loadMore');\n  const searchInput = document.querySelector('.search');\n  const loader = document.querySelector('.loader');\n\n  const errorMessage = 'Sorry, there are no images matching your search query. Please try again!';\n  const limitPostsMessage = 'We\\'re sorry, there are no more posts to load';\n  let page = 1;\n  let limit = 15;\n  let totalPhotos = null;\n  let query = '';\n\n  const handleFetchPhotos = async (e) => {\n    e.preventDefault();\n\n    query = searchInput.value.trim();\n    if (query === '') return;\n\n    clearGallery();\n    page = 1;\n    loader.style.display = 'block';\n    loadMoreBtn.style.display = 'none';\n\n    try {\n      const { hits, totalHits } = await fetchPhotos(query, page);\n      const photos = hits;\n      totalPhotos = totalHits;\n\n      if (photos.length === 0) {\n        throw new Error(errorMessage);\n      }\n\n      renderPhotos(photos);\n      lightbox.refresh();\n      searchInput.value = '';\n      loadMoreBtn.style.display = 'block';\n      scrollToBottom();\n    } catch (error) {\n      handleFetchError(errorMessage);\n    } finally {\n      loader.style.display = 'none';\n    }\n  };\n\n  const handleLoadMorePhotos = async () => {\n    page += 1;\n\n    try {\n      if (page === Math.ceil(totalPhotos / limit)) {\n        loadMoreBtn.style.display = 'none';\n        iziToast.info({ message: limitPostsMessage });\n      }\n\n      const { hits } = await fetchPhotos(query, page);\n      const photos = hits;\n\n      if (photos.length === 0) {\n        throw new Error(errorMessage);\n      }\n      renderPhotos(photos);\n      lightbox.refresh();\n      scrollToBottom();\n    } catch (error) {\n      handleFetchError(errorMessage);\n    } finally {\n      loader.style.display = 'none';\n    }\n  };\n\n  const scrollToBottom = () => {\n    const galleryItem = document.querySelector('.gallery-item');\n    if (galleryItem) {\n      const cardHeight = galleryItem.getBoundingClientRect().height;\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n  };\n\n  const handleFetchError = (error) => {\n    iziToast.error({ message: error });\n    searchInput.value = '';\n  };\n\n  form.addEventListener('submit', handleFetchPhotos);\n  loadMoreBtn.addEventListener('click', handleLoadMorePhotos);\n});\n"],"names":["API_KEY","BASE_URL","initParams","fetchPhotos","q","page","params","axios","gallery","renderPhotos","images","markup","largeImageURL","webformatURL","likes","views","tags","comments","downloads","clearGallery","iziToast","lightbox","SimpleLightbox","form","loadMoreBtn","searchInput","loader","errorMessage","limitPostsMessage","limit","totalPhotos","query","handleFetchPhotos","e","hits","totalHits","photos","scrollToBottom","handleFetchError","handleLoadMorePhotos","galleryItem","cardHeight","error"],"mappings":"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"}